<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.blog.demo.dao.ArticlesMapper">
  <resultMap id="BaseResultMap" type="com.blog.demo.entity.Articles">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Jun 27 15:50:42 CST 2020.
    -->
    <id column="article_id" jdbcType="INTEGER" property="articleId" />
    <result column="sys_user_id" jdbcType="INTEGER" property="sysUserId" />
    <result column="article_title" jdbcType="CHAR" property="articleTitle" />
    <result column="sort_id" jdbcType="INTEGER" property="sortId" />
    <result column="article_date" jdbcType="TIMESTAMP" property="articleDate" />
    <result column="article_cover" jdbcType="VARCHAR" property="articleCover" />
    <result column="article_content" jdbcType="LONGVARCHAR" property="articleContent" />
    <result column="publish_status" jdbcType="CHAR" property="publishStatus" />
  </resultMap>
  <resultMap id="BlogIndex" type="com.blog.demo.entity.BlogIndex">
    <id column="article_id" jdbcType="INTEGER" property="articleId" />
    <result column="article_title" jdbcType="CHAR" property="articleTitle" />
    <result column="article_date" jdbcType="TIMESTAMP" property="articleDate" />  
    <result column="article_cover" jdbcType="VARCHAR" property="articleCover" />
    <result column="article_content" jdbcType="LONGVARCHAR" property="articleContent" />   
  </resultMap>
  <resultMap id="ArticleIndexAdmin" type="com.blog.demo.entity.ArticleIndexAdmin">
    <id column="article_id" jdbcType="INTEGER" property="articleId" />
    <result column="sys_user_id" jdbcType="INTEGER" property="sysUserId" />
    <result column="article_title" jdbcType="CHAR" property="articleTitle" />
    <result column="article_date" jdbcType="TIMESTAMP" property="articleDate" />
    <result column="sort_id" jdbcType="INTEGER" property="sortId" />  
    <result column="publish_status" jdbcType="CHAR" property="publishStatus" />
  </resultMap>
  <!-- 按類別查詢所有索引 -->
  <select id="selectSortBlogIndex" parameterType="java.lang.String" resultMap="BlogIndex">
  	select article_id, article_title, article_date,  article_cover, article_content
    from articles where sort_id=(select sort_id from sorts where sort_name=#{sort_name}) and publish_status="是" ORDER BY article_date DESC
  </select>
  <!-- 查詢前十索引 -->
  <select id="selectAllBlogIndex" resultMap="BlogIndex">
  	select article_id, article_title, article_date,  article_cover, article_content
    from articles where publish_status="是" ORDER BY article_date DESC  limit 10 
  </select>
  <!-- 後台查詢所有索引 -->
  <select id="selectAllArticleIndex" resultMap="ArticleIndexAdmin">
  	 select article_id,sys_user_id, article_title, article_date,sort_id,publish_status
    from articles ORDER BY article_date DESC
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Jun 27 15:50:42 CST 2020.
    -->
    delete from articles
    where article_id = #{articleId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" useGeneratedKeys="true" keyProperty="articleId" parameterType="com.blog.demo.entity.Articles">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Jun 27 15:50:42 CST 2020.
    -->
    insert into articles (article_id, sys_user_id, article_title, 
      sort_id, article_date, article_cover, 
      article_content,publish_status)
    values (#{articleId,jdbcType=INTEGER}, #{sysUserId,jdbcType=INTEGER}, #{articleTitle,jdbcType=CHAR}, 
      #{sortId,jdbcType=INTEGER}, #{articleDate,jdbcType=TIMESTAMP}, #{articleCover,jdbcType=VARCHAR}, 
      #{articleContent,jdbcType=LONGVARCHAR},#{publishStatus,jdbcType=CHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.blog.demo.entity.Articles">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Jun 27 15:50:42 CST 2020.
    -->
    update articles
    set sys_user_id = #{sysUserId,jdbcType=INTEGER},
      article_title = #{articleTitle,jdbcType=CHAR},
      sort_id = #{sortId,jdbcType=INTEGER},
      article_date = #{articleDate,jdbcType=TIMESTAMP},
      article_cover = #{articleCover,jdbcType=VARCHAR},
      article_content = #{articleContent,jdbcType=LONGVARCHAR}
    where article_id = #{articleId,jdbcType=INTEGER}
  </update>
  <update id="publishByBlogId" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Jun 27 15:50:42 CST 2020.
    -->
    update articles
    set publish_status = "是"
    where article_id = #{articleId,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Jun 27 15:50:42 CST 2020.
    -->
    select article_id, sys_user_id, article_title, sort_id, article_date, article_cover, 
    article_content
    from articles
    where article_id = #{articleId,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Jun 27 15:50:42 CST 2020.
    -->
    select article_id, sys_user_id, article_title, sort_id, article_date, article_cover, 
    article_content
    from articles
  </select>
</mapper>